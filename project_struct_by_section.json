{
  "adapters": {
    "domain_adapters.py": {
      "path": "src/adapters/domain_adapters.py",
      "content": null
    },
    "pygame_renderer": {
      "UI.md": {
        "path": "src/adapters/pygame_renderer/UI.md",
        "content": "# Graphical Interface (PyGame Renderer)\n\nThis document describes the architecture, components, and usage of the **PyGame-based graphical interface** for Tactical Micro RTS.\n\n---\n\n## Overview\n\nThe PyGame renderer provides:\n- A **Main Menu** with Start, Settings, and Exit options.\n- A **Settings Screen** to configure game parameters (resolution, log level, scenarios).\n- A **Game Screen** that:\n  - Renders the battle board (adaptive size, centered).\n  - Displays units using emojis.\n  - Shows abilities menu on unit selection.\n  - Allows issuing commands (move, sprint, cast spells).\n  - Simulates ticks via a **Tick** button.\n  - Integrates with the **DomainConnector** for game logic.\n\n## Prerequisites\n\n- Python ‚â• 3.11\n- [PyGame](https://www.pygame.org/) ‚â• 2.0\n\n## Installation\n\n1. Clone the repository:\n   ```bash\n   git clone <repo-url>\n   cd turnshock\n   ```\n2. Create and activate a virtual environment:\n   ```bash\n   python -m venv .venv\n   source .venv/bin/activate\n   ```\n3. Install dependencies:\n   ```bash\n   pip install -r requirements.txt\n   ```\n\n## Running\n\nLaunch the CLI entrypoint:\n```bash\nturnshock\n```\nUse the arrow keys and mouse to navigate menus:\n- **Start**: begin a new game.\n- **Settings**: adjust screen size, scenario source, log level.\n- **Exit**: quit.\n\nIn the **Game Screen**:\n1. **Select unit** by clicking on it.\n2. **Choose ability** from the bottom panel.\n3. **Click target** (cell or unit) to queue an action.\n4. Press **‚è≠ Tick** to advance simulation one tick.\n\n---\n\n## File Structure\n\n```\nsrc/\n‚îî‚îÄ‚îÄ adapters/\n    ‚îî‚îÄ‚îÄ pygame_renderer/\n        ‚îú‚îÄ‚îÄ constants.py        # COLORS, DIMENSIONS, TARGET_FPS\n        ‚îú‚îÄ‚îÄ icons.py            # Emoji mappings for roles, effects, UI\n        ‚îú‚îÄ‚îÄ logger.py           # RTS_Logger configuration\n        ‚îú‚îÄ‚îÄ pygame_renderer.py  # Main loop, screen management\n        ‚îú‚îÄ‚îÄ board_renderer.py   # Adaptive board layout & rendering\n        ‚îî‚îÄ‚îÄ screens/\n            ‚îú‚îÄ‚îÄ base_screen.py     # Abstract BaseScreen class\n            ‚îú‚îÄ‚îÄ menu_screen.py     # Main menu implementation\n            ‚îú‚îÄ‚îÄ settings_screen.py # Settings screen UI\n            ‚îî‚îÄ‚îÄ game_screen.py     # In‚Äëgame screen: rendering, input, tick\n```\n\n### `pygame_renderer.py`\n\n- **PyGameRenderer**: initializes PyGame, reads `cli_settings`, manages current screen.\n- Switches between `MenuScreen`, `SettingsScreen`, and `GameScreen`.\n- Creates and passes a `DomainConnector` to the `GameScreen` for logic.\n\n### Screens\n\n- **BaseScreen**: abstract interface (`handle_event`, `update`, `draw`).\n- **MenuScreen**: buttons for Start, Settings, Exit.\n- **SettingsScreen**: input fields & save/back callbacks.\n- **GameScreen**:\n  - Renders board with `BoardRenderer`.\n  - Manages unit selection and ability menus.\n  - Queues `_pending_actions` and calls `DomainConnector.send_intents`.\n  - Draws unit statuses, action arrows, ability icons.\n\n### `BoardRenderer`\n\n- Computes adaptive cell size to occupy 80% of window height, centered with 5% top / 15% bottom margins.\n- Renders grid, obstacles, regen zones, units (with emoji).\n\n### `icons.py`\n\n- Centralized emoji definitions for unit roles, effects, abilities, and UI buttons.\n\n### Logging\n\n- Uses `RTS_Logger` from `src/config/logger.py`.\n- Each module calls `logger = RTS_Logger()` for contextual logs `[module.name]: message`.\n- Log level controlled via CLI or settings screen.\n\n### Domain Integration\n\n- **DomainConnector** (optional) wraps a separate process or in‚Äëmemory loop; here integrated directly.\n- `GameScreen` passes intents to domain, polls new `GameState`, and re‚Äërenders.\n\n---\n\n## Customization\n\n- **Adding new abilities**: update `icons.py`, domain `base_abilities.py`, and ability logic.\n- **New screens**: subclass `BaseScreen`, register callbacks in `pygame_renderer.py`.\n- **Custom UI**: tweak colors and fonts in `constants.py`.\n- **Logging**: adjust default `cli_settings.log_level`.\n\n---\n\n## Troubleshooting\n\n- **No window appears**: ensure PyGame is installed and X11/Wayland display available.\n- **Fonts not found**: verify `FONT_PATH` in `constants.py`.\n- **Slow performance**: lower `TARGET_FPS` or reduce board size."
      },
      "__init__.py": {
        "path": "src/adapters/pygame_renderer/__init__.py",
        "content": null
      },
      "constants.py": {
        "path": "src/adapters/pygame_renderer/constants.py",
        "content": null
      },
      "icons.py": {
        "path": "src/adapters/pygame_renderer/icons.py",
        "content": null
      },
      "input_handler.py": {
        "path": "src/adapters/pygame_renderer/input_handler.py",
        "content": null
      },
      "pygame_renderer.py": {
        "path": "src/adapters/pygame_renderer/pygame_renderer.py",
        "content": null
      },
      "screens": {
        "__init__.py": {
          "path": "src/adapters/pygame_renderer/screens/__init__.py",
          "content": null
        },
        "base_screen.py": {
          "path": "src/adapters/pygame_renderer/screens/base_screen.py",
          "content": null
        },
        "board_renderer.py": {
          "path": "src/adapters/pygame_renderer/screens/board_renderer.py",
          "content": null
        },
        "game_screen.py": {
          "path": "src/adapters/pygame_renderer/screens/game_screen.py",
          "content": null
        },
        "menu_screen.py": {
          "path": "src/adapters/pygame_renderer/screens/menu_screen.py",
          "content": null
        },
        "settings_screen.py": {
          "path": "src/adapters/pygame_renderer/screens/settings_screen.py",
          "content": null
        }
      }
    }
  },
  "application": {},
  "config": {},
  "domain": {
    "README_DOMAIN.md": {
      "path": "src/domain/README_DOMAIN.md",
      "content": "# Tactical Micro¬†RTS ‚Äî Domain Layer\n\n\n```\ndomain/\n‚îú‚îÄ‚îÄ constants.py      # –†–∞–∑–º–µ—Ä—ã –ø–æ–ª—è, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∏–∫–æ–≤, —Ç–∏–ø TeamId\n‚îú‚îÄ‚îÄ enums.py          # –≤—Å–µ Enum‚Äë—ã (—Ä–æ–ª–∏, —ç—Ñ—Ñ–µ–∫—Ç—ã, —Ç–∏–ø—ã —Ü–µ–ª–µ–π, —Ç–∏–ø—ã Action)\n‚îÇ\n‚îú‚îÄ‚îÄ geometry/         # –ü—Ä–æ—Å—Ç—ã–µ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã\n‚îÇ   ‚îî‚îÄ‚îÄ position.py   # dataclass Position, –º–µ—Ç—Ä–∏–∫–∏, in_bounds\n‚îÇ\n‚îú‚îÄ‚îÄ core/             # ¬´–î–∞–Ω–Ω—ã–µ –±–µ–∑ –ø–æ–≤–µ–¥–µ–Ω–∏—è¬ª\n‚îÇ   ‚îú‚îÄ‚îÄ stats.py      # UnitStats\n‚îÇ   ‚îú‚îÄ‚îÄ ability.py    # Ability\n‚îÇ   ‚îú‚îÄ‚îÄ effect.py     # Effect\n‚îÇ   ‚îú‚îÄ‚îÄ board.py      # Board\n‚îÇ   ‚îú‚îÄ‚îÄ unit.py       # HeroUnit\n‚îÇ   ‚îî‚îÄ‚îÄ state.py      # GameState\n‚îÇ\n‚îú‚îÄ‚îÄ rules/            # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–∫–æ–Ω–Ω–æ—Å—Ç–∏\n‚îÇ   ‚îú‚îÄ‚îÄ move.py       # legal_moves(), validate_move()\n‚îÇ   ‚îî‚îÄ‚îÄ ability.py    # legal_targets(), validate_ability()\n‚îÇ\n‚îú‚îÄ‚îÄ engine/           # –ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∏–º—É–ª—è—Ü–∏–∏\n‚îÇ   ‚îú‚îÄ‚îÄ applier.py    # apply_ability()\n‚îÇ   ‚îú‚îÄ‚îÄ ticker.py     # start_turn(), resolve_tick_effects()\n‚îÇ   ‚îî‚îÄ‚îÄ simulate.py   # simulate_turn()\n‚îÇ\n‚îî‚îÄ‚îÄ heroes/           # –§–∞–±—Ä–∏–∫–∏ –≥–æ—Ç–æ–≤—ã—Ö —é–Ω–∏—Ç–æ–≤\n    ‚îú‚îÄ‚îÄ base.py\n    ‚îú‚îÄ‚îÄ defender.py ‚Ä¶\n```\n\n## –ü–æ—Ç–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π\n\n```\ngeometry  ‚îê\nconstants ‚îú‚îÄ‚Üí core ‚îÄ‚Üí rules ‚îÄ‚Üí engine\nenums     ‚îò\nheroes ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       (—Ç–æ–ª—å–∫–æ –∫ core)\n```\n\n# RTS Game Rules (Tick-based)\n\n## 1. Game Map\n- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ: –∫–≤–∞–¥—Ä–∞—Ç–Ω–∞—è —Å–µ—Ç–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 13x13)\n- –ü—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è: –Ω–µ–ª—å–∑—è –ø—Ä–æ–π—Ç–∏/—Å—Ç—Ä–µ–ª—è—Ç—å —Å–∫–≤–æ–∑—å\n- –ó–æ–Ω—ã: –±–∞—Ñ—Ñ—ã/—Ä–µ–≥–µ–Ω\n\n## 2. Units\n- –ö–∞–∂–¥—ã–π –ø–µ—Ä—Å–æ–Ω–∞–∂ ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å\n- –ú–æ–∂–µ—Ç –±—ã—Ç—å –∂–∏–≤—ã–º –∏–ª–∏ –º–µ—Ä—Ç–≤—ã–º\n\n## 3. Tick Loop\n\n–ö–∞–∂–¥—ã–π —Ç–∏–∫:\n1. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤:**  \n    - –£ –∫–∞–∂–¥–æ–≥–æ —é–Ω–∏—Ç–∞ –¥–µ–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è duration –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤\n    - –≠—Ñ—Ñ–µ–∫—Ç—ã —Å duration=0 –∏—Å—á–µ–∑–∞—é—Ç\n2. **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π:**  \n    - –ö–∞–∂–¥—ã–π –∂–∏–≤–æ–π —é–Ω–∏—Ç –ø–æ–ª—É—á–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–¥–µ–ª–∞—Ç—å 1 –¥–µ–π—Å—Ç–≤–∏–µ (move/attack/use ability)\n    - –ï—Å–ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ ‚Äî –æ–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è\n    - –ö–æ–ª–ª–∏–∑–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–≤–∞ —é–Ω–∏—Ç–∞ —Ö–æ—Ç—è—Ç –æ–¥–Ω—É –∫–ª–µ—Ç–∫—É): –æ–±–∞ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ –º–µ—Å—Ç–µ/–æ–±–∞ fail\n3. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –∫–ª–µ—Ç–æ–∫:**  \n    - –ù–∞–ø—Ä–∏–º–µ—Ä, —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è\n4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ü–∞ –∏–≥—Ä—ã:**  \n    - –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∞ ‚Äî –∫–æ–Ω–µ—Ü –∏–≥—Ä—ã\n    \n–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (CLI/React/Gym) –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ–ª—å–∫–æ  \n`domain.engine.simulate_turn()` –∏ —Ñ–∞–±—Ä–∏–∫–∏ –∏–∑ `domain.heroes`."
    },
    "__init__.py": {
      "path": "src/domain/__init__.py",
      "content": null
    },
    "constants.py": {
      "path": "src/domain/constants.py",
      "content": null
    },
    "enums.py": {
      "path": "src/domain/enums.py",
      "content": null
    },
    "errors.py": {
      "path": "src/domain/errors.py",
      "content": null
    },
    "heroes": {
      "README.md": {
        "path": "src/domain/heroes/README.md",
        "content": "# –ü–∞–∫–µ—Ç `heroes`\n\n–°–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∞–±—Ä–∏–∫–∏ `create_*` –∏ –∑–∞–≥–æ—Ç–æ–≤–∫–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π.  \n–ù–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç `rules` –∏–ª–∏ `engine` ‚Äî —Ç–æ–ª—å–∫–æ `core`."
      },
      "archer_profile.py": {
        "path": "src/domain/heroes/archer_profile.py",
        "content": null
      },
      "base_abilities.py": {
        "path": "src/domain/heroes/base_abilities.py",
        "content": null
      },
      "defender_profile.py": {
        "path": "src/domain/heroes/defender_profile.py",
        "content": null
      },
      "mage_dps_profile.py": {
        "path": "src/domain/heroes/mage_dps_profile.py",
        "content": null
      },
      "mage_supp_profile.py": {
        "path": "src/domain/heroes/mage_supp_profile.py",
        "content": null
      },
      "profile.py": {
        "path": "src/domain/heroes/profile.py",
        "content": null
      },
      "swordsman_profile.py": {
        "path": "src/domain/heroes/swordsman_profile.py",
        "content": null
      }
    },
    "engine": {
      "__init__.py": {
        "path": "src/domain/engine/__init__.py",
        "content": null
      },
      "ability_utils.py": {
        "path": "src/domain/engine/ability_utils.py",
        "content": null
      },
      "applier.py": {
        "path": "src/domain/engine/applier.py",
        "content": null
      },
      "combat.py": {
        "path": "src/domain/engine/combat.py",
        "content": null
      },
      "engine.md": {
        "path": "src/domain/engine/engine.md",
        "content": "# üß† `domain.engine/` ‚Äî –õ–æ–≥–∏–∫–∞ —Å–∏–º—É–ª—è—Ü–∏–∏ –±–æ—è\n\n–ú–æ–¥—É–ª—å `domain.engine` —Å–æ–¥–µ—Ä–∂–∏—Ç **—è–¥—Ä–æ —Å–∏–º—É–ª—è—Ü–∏–∏ –∏–≥—Ä–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ —Ç–∏–∫–æ–≤–æ–π –º–æ–¥–µ–ª–∏**.  \n–û–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞:\n\n- –ø—Ä–æ–≥—Ä–µ—Å—Å —Ç–∏–∫–∞ (`event_tick`)\n- –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π (`apply_ability`)\n- —Ä–∞—Å—á–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ (`damage`, `heal`, `effects`)\n- –≤—ã–±–æ—Ä —Ü–µ–ª–µ–π (`chain targeting`)\n- –∑–∞–ø–∏—Å—å –±–æ–µ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (`stats_tracker`)\n\n---\n\n## üîÅ `event_loop.py` ‚Äî –≥–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª —Å–∏–º—É–ª—è—Ü–∏–∏\n\n–§—É–Ω–∫—Ü–∏—è `event_tick(state, intents)`:\n\n1. **–û–±–Ω–æ–≤–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç—ã** (—É–º–µ–Ω—å—à–∞–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å).\n2. **–ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∑–æ–Ω—ã** (regen_zone).\n3. **–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç AP**.\n4. **–í—ã–ø–æ–ª–Ω—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è —é–Ω–∏—Ç–æ–≤**:\n   - –µ—Å–ª–∏ –∏–¥–µ—Ç –∫–∞—Å—Ç ‚Üí –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º\n   - –µ—Å–ª–∏ –ø—Ä–∏—à–µ–ª –Ω–æ–≤—ã–π –∏–Ω—Ç–µ–Ω—Ç ‚Üí –ø—Ä–µ—Ä—ã–≤–∞–µ–º –∏ –∑–∞–º–µ–Ω—è–µ–º\n   - –∏–Ω–∞—á–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ç–µ–∫—É—â–µ–µ (–¥–≤–∏–∂–µ–Ω–∏–µ/–æ–∂–∏–¥–∞–Ω–∏–µ)\n\n**–ï—Å–ª–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —ç—Ñ—Ñ–µ–∫—Ç—ã** ‚Äî –æ–Ω–∞ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ `apply_ability`.\n\n---\n\n## ‚ú® `applier.py` ‚Äî –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π\n\n–§—É–Ω–∫—Ü–∏—è `apply_ability(...)`:\n- —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ `stats_tracker`\n- –≤—ã–±–∏—Ä–∞–µ—Ç —Ü–µ–ª–∏ (—É—á–∏—Ç—ã–≤–∞—è AoE)\n- –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∫–∞–∂–¥—ã–π `Effect`:\n  - `DAMAGE` ‚Üí `apply_damage_to_unit`\n  - `HEAL` ‚Üí `apply_heal_to_unit`\n  - `BUFF/DEBUFF/SHIELD` ‚Üí `add_effect_to_unit`\n\n---\n\n## üîó `ability_utils.py` ‚Äî –≤—ã–±–æ—Ä —Ü–µ–ª–µ–π\n\n- `select_chain_targets(...)` ‚Äî –¥–ª—è —Ü–µ–ø–Ω—ã—Ö –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π:\n  –≤—ã–±–∏—Ä–∞–µ—Ç –¥–æ N –±–ª–∏–∂–∞–π—à–∏—Ö —Ü–µ–ª–µ–π –≤ —Ä–∞–¥–∏—É—Å–µ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞.\n\n---\n\n## üß™ `combat.py` ‚Äî –ø—Ä–∏–º–∏—Ç–∏–≤—ã —É—Ä–æ–Ω–∞/—Ö–∏–ª–∞\n\n- `calculate_damage()` ‚Äî —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ BUFF-—ç—Ñ—Ñ–µ–∫—Ç—ã.\n- `apply_damage_to_unit()` ‚Äî —É—Ä–æ–Ω —Å —É—á–µ—Ç–æ–º —â–∏—Ç–∞.\n- `apply_heal_to_unit()` ‚Äî —Ö–∏–ª –¥–æ max_hp.\n- `add_effect_to_unit()` ‚Äî –Ω–∞–≤–µ—à–∏–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç.\n\n---\n\n## üß© –í–∑–∞–∏–º–æ—Å–≤—è–∑–∏:\n\n- `event_loop` –≤—ã–∑—ã–≤–∞–µ—Ç `apply_ability`\n- `apply_ability` –≤—ã–∑—ã–≤–∞–µ—Ç `combat` –∏ `stats`\n- –í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å `GameState` –∏ `HeroUnit`\n\n---\n\n## üí° –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:\n\n```python\nstate, executed, done = event_tick(state, intents)\n```\n\n---\n\n## üìå –ì–¥–µ –ª–æ–≥–∏–∫–∞ –ù–ï –∂–∏–≤–µ—Ç:\n- –ù–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ —É—Å–ª–æ–≤–∏–π/AI ‚Äî —Ç–æ–ª—å–∫–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ.\n- –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (LoS, range) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–¥–µ–ª–∞–Ω—ã –¥–æ –ø–µ—Ä–µ–¥–∞—á–∏ `intent`."
      },
      "event_loop.py": {
        "path": "src/domain/engine/event_loop.py",
        "content": null
      }
    },
    "factory": {
      "game_factory.py": {
        "path": "src/domain/factory/game_factory.py",
        "content": null
      },
      "unit_factory.py": {
        "path": "src/domain/factory/unit_factory.py",
        "content": null
      }
    },
    "analytics": {
      "analytics.md": {
        "path": "src/domain/analytics/analytics.md",
        "content": "# üìä Domain Analytics\n\n–ü–∞–ø–∫–∞ `src/domain/analytics` –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–±–æ—Ä –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏–≥—Ä—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –¥–æ–º–µ–Ω–∞:\n- —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –∫–∞–∂–¥—ã–π —é–Ω–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –∫–∞–∂–¥—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å;\n- —Å–∫–æ–ª—å–∫–æ —É—Ä–æ–Ω–∞ –æ–Ω –Ω–∞–Ω—ë—Å –≤—Ä–∞–≥–∞–º –∏ —Å–æ—é–∑–Ω–∏–∫–∞–º;\n- —Å–∫–æ–ª—å–∫–æ –∏—Å—Ü–µ–ª–∏–ª;\n- –∫–∞–∫–∏–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–∞–ª–æ–∂–∏–ª –∏ –≤ –∫–∞–∫–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ.\n\n–í —ç—Ç–æ–π –ø–∞–ø–∫–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –º–æ–¥—É–ª—å:\n\n---\n\n## stats.py\n\n```python\nfrom dataclasses import dataclass, field\nfrom typing import Dict\nfrom ..core.effect import EffectType\n\n@dataclass\nclass AbilityStats:\n    uses: int = 0\n    damage_to_enemies: int = 0\n    damage_to_allies: int = 0\n    healing: int = 0\n    effects_applied: Dict[EffectType, int] = field(default_factory=dict)\n\n@dataclass\nclass UnitStats:\n    by_ability: Dict[str, AbilityStats] = field(default_factory=dict)\n\nclass StatsTracker:\n    \"\"\"\n    –°–æ–±–∏—Ä–∞–µ—Ç per-tick –∏ –∏—Ç–æ–≥–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫–∞–∂–¥–æ–º—É —é–Ω–∏—Ç—É:\n      - record_use       ‚Äî —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏\n      - record_damage    ‚Äî —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç —Å–∫–æ–ª—å–∫–æ —É—Ä–æ–Ω–∞ –Ω–∞–Ω–µ—Å–µ–Ω–æ –∏ –∫–æ–º—É (–≤—Ä–∞–≥/—Å–æ—é–∑–Ω–∏–∫)\n      - record_heal      ‚Äî —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç —Å–∫–æ–ª—å–∫–æ –∏—Å—Ü–µ–ª–µ–Ω–æ\n      - record_effect    ‚Äî —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç, —Å–∫–æ–ª—å–∫–æ –∏ –∫–∞–∫–∏—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –Ω–∞–ª–æ–∂–µ–Ω–æ\n      - get_stats        ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Ç–æ–≥–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –≤—Å–µ–º —é–Ω–∏—Ç–∞–º\n      - reset            ‚Äî –æ—á–∏—â–∞–µ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ\n    \"\"\"\n    def __init__(self):\n        self.units: Dict[int, UnitStats] = {}\n\n    def _get_ability_stats(self, caster_id: int, ability_name: str) -> AbilityStats:\n\n    def record_use(self, caster_id: int, ability_name: str) -> None:\n\n    def record_damage(self, caster_id: int, ability_name: str, amount: int, enemy: bool) -> None:\n\n    def record_heal(self, caster_id: int, ability_name: str, amount: int) -> None:\n    \n    def record_effect(self, caster_id: int, ability_name: str, eff_type: EffectType, amount: int) -> None:\n\n    def get_stats(self) -> Dict[int, UnitStats]:\n\n    def reset(self) -> None:\n        \n\n# –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Ç—Ä–µ–∫–µ—Ä, –¥–æ—Å—Ç—É–ø–Ω—ã–π –≤–æ –≤—Å—ë–º –¥–æ–º–µ–Ω–µ\nstats_tracker = StatsTracker()\n–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç\n–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –¥–æ–º–µ–Ω\n–í —Ñ—É–Ω–∫—Ü–∏–∏ apply_ability (–≤ domain/engine/applier.py) –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –º–µ—Ç–æ–¥—ã stats_tracker.record_*, —á—Ç–æ–±—ã –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å:\n\n—Ñ–∞–∫—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (record_use),\n\n–ø—Ä–∏–Ω–µ—Å—ë–Ω–Ω—ã–π —É—Ä–æ–Ω (record_damage),\n\n–æ—Ç—Ö–∏–ª (record_heal),\n\n–Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ–º—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã (record_effect).\n\n–°–±–æ—Ä –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ\nStatsTracker —Ö—Ä–∞–Ω–∏—Ç –≤ –ø–æ–ª–µ units —Å–ª–æ–≤–∞—Ä—å:\n\npython\n\n{\n  unit_id: UnitStats(by_ability={\n    \"fireball\": AbilityStats(...),\n    \"move_to\":  AbilityStats(...),\n    ...\n  }),\n  ...\n}\n–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤\n–í –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–∏–∫–æ–≤) –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å:\n\npython\nCopy\nEdit\nfrom domain.analytics.stats import stats_tracker\nfinal_stats = stats_tracker.get_stats()\n–∏ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—É—é —Ä–∞–∑–±–∏–≤–∫—É –ø–æ –∫–∞–∂–¥–æ–º—É —é–Ω–∏—Ç—É –∏ –∫–∞–∂–¥–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏.\n\n–°–±—Ä–æ—Å\n–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –Ω–∞—á–∞—Ç—å –Ω–æ–≤—ã–π –º–∞—Ç—á –∏–ª–∏ —Ç–µ—Å—Ç, –≤—ã–∑—ã–≤–∞–µ–º stats_tracker.reset(), —á—Ç–æ–±—ã –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ.\n\n–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è\n\n# ... –≤ –Ω–∞—á–∞–ª–µ –∏–≥—Ä—ã\nstats_tracker.reset()\n\n# –≤–æ –≤—Ä–µ–º—è –∏–≥—Ä—ã ‚Äî –≤—Å—ë –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–Ω—É—Ç—Ä–∏ apply_ability\n\n# –≤ –∫–æ–Ω—Ü–µ –∏–≥—Ä—ã\nfor unit_id, u_stats in stats_tracker.get_stats().items():\n    print(f\"–Æ–Ω–∏—Ç {unit_id}:\")\n    for ability_name, ab in u_stats.by_ability.items():\n        print(f\"  {ability_name}: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ {ab.uses} —Ä–∞–∑, \"\n              f\"—É—Ä–æ–Ω –≤—Ä–∞–≥–∞–º={ab.damage_to_enemies}, —É—Ä–æ–Ω —Å–æ—é–∑–Ω–∏–∫–∞–º={ab.damage_to_allies}, \"\n              f\"–ª–µ—á–µ–Ω–∏–µ={ab.healing}, —ç—Ñ—Ñ–µ–∫—Ç—ã={ab.effects_applied}\")\n\n–î–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∞–º –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –±—ã—Å—Ç—Ä–æ –ø–æ–ª—É—á–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø–æ –±–∞–ª–∞–Ω—Å—É —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –∏ –ø–æ–≤–µ–¥–µ–Ω–∏—é —é–Ω–∏—Ç–æ–≤ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏ —Å–∏–º—É–ª—è—Ü–∏–∏."
      },
      "stats.py": {
        "path": "src/domain/analytics/stats.py",
        "content": null
      }
    },
    "core": {
      "__init__.py": {
        "path": "src/domain/core/__init__.py",
        "content": null
      },
      "ability.py": {
        "path": "src/domain/core/ability.py",
        "content": null
      },
      "action.py": {
        "path": "src/domain/core/action.py",
        "content": null
      },
      "board.py": {
        "path": "src/domain/core/board.py",
        "content": null
      },
      "core.md": {
        "path": "src/domain/core/core.md",
        "content": "# üß© Domain Core Overview\n\n**`src/domain/core/`** ‚Äî —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–ª–æ–π –¥–æ–º–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π –∏–≥—Ä–æ–≤–æ–π –ª–æ–≥–∏–∫–∏: —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π, —ç—Ñ—Ñ–µ–∫—Ç–æ–≤, –¥–æ—Å–∫–∏, —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã –∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.\n\n---\n\n## –ú–æ–¥—É–ª–∏ –∏ –∫–ª–∞—Å—Å—ã\n\n### 1. `ability.py` ‚Äî **–°–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (Abilities)**\n\n```python\n@dataclass(frozen=True, slots=True)\nclass Ability:\n    name: str                # –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, \"fireball\")\n    range: int               # –î–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è\n    cost: int                # –°—Ç–æ–∏–º–æ—Å—Ç—å –≤ AP\n    target: TargetType       # –¢–∏–ø —Ü–µ–ª–∏: SELF, ENEMY, ALLY –∏ –¥—Ä.\n    effects: FrozenSet[Effect]  # –ù–∞–±–æ—Ä —ç—Ñ—Ñ–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç –∞–±–∏–ª–∫–∞\n    cast_time: int = 1       # –°–∫–æ–ª—å–∫–æ —Ç–∏–∫–æ–≤ –¥–ª–∏—Ç—Å—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ\n    aoe: int = 0             # –†–∞–¥–∏—É—Å –¥–µ–π—Å—Ç–≤–∏—è (0 ‚Äî –æ–¥–Ω–æ—Ü–µ–ª–µ–≤–∞—è)\n    bounces: int = 0         # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ \"–ø—Ä—ã–∂–∫–æ–≤\" (–¥–ª—è —Ü–µ–ø–Ω—ã—Ö —É–º–µ–Ω–∏–π)\n    bounce_mult: float = 1.0 # –ú–Ω–æ–∂–∏—Ç–µ–ª—å —Å–∏–ª—ã –ø—Ä—ã–∂–∫–∞\n–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:\n–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, \"melee_attack\", \"move_to\", \"fireball\"). –ê–±–∏–ª–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è.\n\n2. action.py ‚Äî –ê–∫—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (Active Actions)\npython\nCopy\nEdit\n@dataclass\nclass ActiveAction:\n    ability: Ability\n    target: Position\n    ticks_remaining: int\n    path: Optional[List[Position]] = None\n    target_unit_id: Optional[int] = None\n    started: bool = False\n\n    def tick(self) -> bool:\n        self.ticks_remaining -= 1\n        return self.ticks_remaining <= 0\n–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:\n–•—Ä–∞–Ω–∏—Ç —Ç–µ–∫—É—â–µ–µ \"–ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–µ–µ\" –¥–µ–π—Å—Ç–≤–∏–µ —é–Ω–∏—Ç–∞: –∫–∞–∫—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –æ–Ω –∫–∞—Å—Ç—É–µ—Ç, –ø–æ –∫–∞–∫–æ–π —Ü–µ–ª–∏, —Å–∫–æ–ª—å–∫–æ —Ç–∏–∫–æ–≤ –æ—Å—Ç–∞–ª–æ—Å—å, –∫–∞–∫–æ–π –ø—É—Ç—å –∏–¥—ë—Ç (–¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è), –Ω–∞—á–∞—Ç–æ –ª–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ.\n–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—ç—Ç–∞–ø–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π (–¥–≤–∏–∂–µ–Ω–∏–µ, –¥–ª–∏—Ç–µ–ª—å–Ω—ã–µ –∫–∞—Å—Ç—ã).\n\n3. board.py ‚Äî –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ (Board)\npython\nCopy\nEdit\n@dataclass(slots=True)\nclass Board:\n    obstacles: Set[Position] = field(default_factory=set)\n    regen_zone: Set[Position] = field(default_factory=set)\n\n    def is_blocked(self, pos: Position) -> bool\n    def is_line_blocked(self, a: Position, b: Position) -> bool\n    def apply_zone_effects(self, state: 'GameState') -> None\n–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:\n–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∫–∞—Ä—Ç—É —É—Ä–æ–≤–Ω—è:\n\nobstacles ‚Äî –∫–ª–µ—Ç–∫–∏-—Å—Ç–µ–Ω—ã, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –Ω–µ–ª—å–∑—è –ø—Ä–æ–π—Ç–∏/–ø—Ä–æ—Å—Ç—Ä–µ–ª–∏—Ç—å.\n\nregen_zone ‚Äî –∫–ª–µ—Ç–∫–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è HP.\n\n–ú–µ—Ç–æ–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –º–æ–∂–Ω–æ –ª–∏ –ø—Ä–æ–π—Ç–∏/–ø—Ä–æ—Å—Ç—Ä–µ–ª–∏—Ç—å –º–µ–∂–¥—É –¥–≤—É–º—è —Ç–æ—á–∫–∞–º–∏, –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∑–æ–Ω–∞–ª—å–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤.\n\n4. effect.py ‚Äî –≠—Ñ—Ñ–µ–∫—Ç—ã (Effects)\npython\nCopy\nEdit\n@dataclass(frozen=True, slots=True)\nclass Effect:\n    type: EffectType    # –¢–∏–ø —ç—Ñ—Ñ–µ–∫—Ç–∞ (DAMAGE, HEAL, SHIELD –∏ –¥—Ä.)\n    value: int          # –ó–Ω–∞—á–µ–Ω–∏–µ (—Å–∫–æ–ª—å–∫–æ HP –ª–µ—á–∏—Ç/—Å–Ω–∏–º–∞–µ—Ç, —Å–∏–ª–∞ —â–∏—Ç–∞ –∏ –¥—Ä.)\n    duration: int       # –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–≤ —Ç–∏–∫–∞—Ö)\n–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:\n–ö–ª–∞—Å—Å –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ (—É—Ä–æ–Ω, —â–∏—Ç, –∑–∞–º–µ–¥–ª–µ–Ω–∏–µ –∏ –¥—Ä.), –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –∞–±–∏–ª–∫–æ–π –Ω–∞ —Ü–µ–ª—å.\n\n5. state.py ‚Äî –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã (GameState)\npython\nCopy\nEdit\n@dataclass(slots=True)\nclass GameState:\n    tick: int\n    units: Dict[int, HeroUnit]\n    board: Board\n\n    def clear_temporary(self) -> None\n    def get_unit_at(self, pos)\n    def is_game_over(self) -> bool\n–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:\n\n–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Å—é –∏–≥—Ä–æ–≤—É—é \"–∫–∞—Ä—Ç–∏–Ω—É\": –∫—Ç–æ –∂–∏–≤, –∫—Ç–æ –≥–¥–µ —Å—Ç–æ–∏—Ç, –∫–∞–∫–∏–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è.\n\n–•—Ä–∞–Ω–∏—Ç –≤—Å–µ —é–Ω–∏—Ç—ã (units) –∏ –∏–≥—Ä–æ–≤—É—é –¥–æ—Å–∫—É (board).\n\n–ú–µ—Ç–æ–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —é–Ω–∏—Ç—É –ø–æ –ø–æ–∑–∏—Ü–∏–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ü–∞ –∏–≥—Ä—ã.\n\n–í–∑–∞–∏–º–æ—Å–≤—è–∑–∏\nAbility –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ ActiveAction (–∫–∞–∫—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∫–∞—Å—Ç—É–µ—Ç —é–Ω–∏—Ç).\n\nEffect —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ Ability (—á—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –ø—Ä–∏ –∫–∞—Å—Ç–µ).\n\nBoard –∏ GameState –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—è –∏ –æ–±—ä–µ–∫—Ç–æ–≤.\n\nGameState —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —é–Ω–∏—Ç—ã (HeroUnit) –∏ –¥–æ—Å–∫—É (Board).\n\nActiveAction (—É —é–Ω–∏—Ç–∞) ‚Äî –∫–ª—é—á–µ–≤–æ–π –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏ –º–µ—Ö–∞–Ω–∏–∑–º \"—á—Ç–æ —Å–µ–π—á–∞—Å –¥–µ–ª–∞–µ—Ç —é–Ω–∏—Ç\".\n\n–î–ª—è —á–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –∫–ª–∞—Å—Å—ã?\nAbility ‚Äî –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞ –∏–ª–∏ –∏–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å.\n\nActiveAction ‚Äî –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–Ω–∞—Ç—å, —á—Ç–æ —Å–µ–π—á–∞—Å –¥–µ–ª–∞–µ—Ç —é–Ω–∏—Ç –∏ —Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Å—Ç–∞–ª–æ—Å—å.\n\nBoard ‚Äî –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –º–æ–∂–Ω–æ –ª–∏ —Ö–æ–¥–∏—Ç—å/—Å—Ç—Ä–µ–ª—è—Ç—å –ø–æ –∫–ª–µ—Ç–∫–µ.\n\nEffect ‚Äî —á—Ç–æ–±—ã –Ω–∞–≤–µ—Å–∏—Ç—å/—Å–Ω—è—Ç—å —ç—Ñ—Ñ–µ–∫—Ç—ã —Å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞.\n\nGameState ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è —Ç–æ—á–∫–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é –∏–≥—Ä—ã –≤ –ª—é–±–æ–º —Ç–∏–∫–µ.\n\n–í—Å–µ —ç—Ç–∏ –∫–ª–∞—Å—Å—ã –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ª–æ–≥–∏–∫–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è (–∫—Ä–æ–º–µ –º–µ—Ç–æ–¥–æ–≤ –¥–æ—Å—Ç—É–ø–∞ –∏ –ø—Ä–æ—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π) –∏ –æ–±—Ä–∞–∑—É—é—Ç —á–∏—Å—Ç—É—é, –Ω–µ–∑–∞–≤–∏—Å–∏–º—É—é –¥–æ–º–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å. –í—Å—è \"–º–∞–≥–∏—è\" —Å–∏–º—É–ª—è—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ engine ‚Äî —ç—Ç–∏ –∫–ª–∞—Å—Å—ã –ª–∏—à—å –µ—ë –æ–ø–∏—Å—ã–≤–∞—é—Ç.\n\n# üì¶ src/domain/core ‚Äî –ú–æ–¥–µ–ª—å —é–Ω–∏—Ç–∞ –∏ —Å—Ç–∞—Ç—ã\n\n## –ú–æ–¥—É–ª—å `unit_stats.py`\n–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –±–∞–∑–æ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ª—é–±–æ–≥–æ —é–Ω–∏—Ç–∞ (–Ω–µ –∏–≥—Ä–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∞ \"–ø–∞—Å–ø–æ—Ä—Ç\"):\n\n```python\n@dataclass(frozen=True, slots=True)\nclass UnitStats:\n    \"\"\"\n    –ë–∞–∑–æ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —é–Ω–∏—Ç–∞:\n      - hp_max       ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ\n      - move_range   ‚Äî —Å–∫–æ–ª—å–∫–æ –∫–ª–µ—Ç–æ–∫ –º–æ–∂–µ—Ç –ø—Ä–æ–π—Ç–∏ –∑–∞ 1 AP\n      - block_chance ‚Äî —à–∞–Ω—Å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —á–∞—Å—Ç—å —É—Ä–æ–Ω–∞ (0-100%)\n      - max_ap       ‚Äî —Å–∫–æ–ª—å–∫–æ AP —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ —Ö–æ–¥–∞\n    \"\"\"\n    hp_max: int\n    move_range: int = 1\n    block_chance: int = 0\n    max_ap: int = MAX_AP\n–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ—Ñ–∏–ª–µ –≥–µ—Ä–æ—è, —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –∏ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ –æ–ø–∏—Å—ã–≤–∞—Ç—å –≤—Å–µ \"–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ\" –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —é–Ω–∏—Ç–∞.\n\n–ú–æ–¥—É–ª—å unit.py\n–Ø–¥—Ä–æ –º–æ–¥–µ–ª–∏ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞: HeroUnit.\n\n–û—Å–Ω–æ–≤–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã:\n–•—Ä–∞–Ω–∏—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —é–Ω–∏—Ç–∞ (HP, AP, –ø–æ–∑–∏—Ü–∏—è, —ç—Ñ—Ñ–µ–∫—Ç—ã, —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ).\n\n–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å \"–±–æ–µ–≤—ã–º–∏\" –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ —á–µ—Ä–µ–∑ combat-–º–æ–¥—É–ª—å.\n\n–†–µ–∞–ª–∏–∑—É–µ—Ç –ª–æ–≥–∏–∫—É —Å—Ç–∞—Ä—Ç–∞ –∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è —Å –∞–≤—Ç–æ–ø–æ–≤—Ç–æ—Ä–æ–º.\n\n–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–Ω–æ–≤–æ —Å—Ç–∞–≤–∏—Ç –¥–µ–π—Å—Ç–≤–∏–µ –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è (–¥–æ override).\n\n–†–∞–±–æ—Ç–∞–µ—Ç —Å pathfinding –¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è.\n\n–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—é: —É—Ä–æ–Ω, –ª–µ—á–µ–Ω–∏–µ, —ç—Ñ—Ñ–µ–∫—Ç—ã ‚Äî –≤ combat.\n\npython\nCopy\nEdit\n@dataclass(slots=True)\nclass HeroUnit:\n    id: int\n    role: UnitRole\n    team: TeamId\n    pos: Position\n    profile: CharacterProfile\n    hp: int = field(init=False)\n    ap: int = field(init=False)\n    effects: list[Effect] = field(default_factory=list, init=False)\n    current_action: Optional[ActiveAction] = field(default=None, init=False)\n    ...\n–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:\ntick_effects ‚Äî —É–º–µ–Ω—å—à–∞–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–æ–≤, —É–¥–∞–ª—è—è –∏—Å—Ç—ë–∫—à–∏–µ.\n\napply_ap_regen ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç AP –ø–æ –ø—Ä–æ—Ñ–∏–ª—é.\n\napply_damage/apply_heal/add_effect ‚Äî –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –±–æ–µ–≤—ã–º –æ–ø–µ—Ä–∞—Ü–∏—è–º (–¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç combat-–º–æ–¥—É–ª—é).\n\nstart_action ‚Äî –Ω–∞—á–∏–Ω–∞–µ—Ç –Ω–æ–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ (–µ—Å–ª–∏ –Ω–µ –∫–∞—Å—Ç—É–µ—Ç —á—Ç–æ-—Ç–æ).\n\nadvance_action ‚Äî —Ä–µ–∞–ª–∏–∑—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª: –¥–≤–∏–∂–µ–Ω–∏–µ, –∫–∞—Å—Ç—ã, –ø–æ–≤—Ç–æ—Ä.\n\n–¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:\nUnitStats ‚Äî –∫–æ–≥–¥–∞ –Ω–∞–¥–æ –ø–æ–ª—É—á–∏—Ç—å/–∑–∞–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –Ω–µ –∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–æ—è.\n\nHeroUnit ‚Äî –≤—Å–µ–≥–¥–∞ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –∏–≥—Ä–æ–≤–æ–º—É —é–Ω–∏—Ç—É –≤ GameState.\n\n–û—Ç–ª–∏—á–∏–µ:\nUnitStats ‚Äî –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–π –Ω–∞–±–æ—Ä —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ (\"–ø—Ä–æ—Ñ–∏–ª—å\" —é–Ω–∏—Ç–∞, –∞–Ω–∞–ª–æ–≥ D&D stat block).\n\nHeroUnit ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ, –∏–∑–º–µ–Ω—è–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —é–Ω–∏—Ç–∞ –Ω–∞ –∫–∞—Ä—Ç–µ (HP, AP, —ç—Ñ—Ñ–µ–∫—Ç—ã, –ø–æ–∑–∏—Ü–∏—è, —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ).\n\n–í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:\n–ë–æ–µ–≤–∞—è –ª–æ–≥–∏–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤—ã–≤–µ–¥–µ–Ω–∞ –≤ combat-–º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.\n\n–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —é–Ω–∏—Ç–∞ (–∫–∞—Å—Ç, –¥–≤–∏–∂–µ–Ω–∏–µ, –æ–∂–∏–¥–∞–Ω–∏–µ) –¥–æ–ª–∂–Ω—ã –∏–¥—Ç–∏ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ advance_action.\n\ncurrent_action –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è, –ø–æ–∫–∞ –Ω–µ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–æ –Ω–æ–≤—ã–º –∏–Ω—Ç–µ–Ω—Ç–æ–º."
      },
      "effect.py": {
        "path": "src/domain/core/effect.py",
        "content": null
      },
      "state.py": {
        "path": "src/domain/core/state.py",
        "content": null
      },
      "stats.py": {
        "path": "src/domain/core/stats.py",
        "content": null
      },
      "unit.py": {
        "path": "src/domain/core/unit.py",
        "content": null
      }
    },
    "geometry": {
      "README.md": {
        "path": "src/domain/geometry/README.md",
        "content": ""
      },
      "__init__.py": {
        "path": "src/domain/geometry/__init__.py",
        "content": null
      },
      "pathfinding.py": {
        "path": "src/domain/geometry/pathfinding.py",
        "content": null
      },
      "position.py": {
        "path": "src/domain/geometry/position.py",
        "content": null
      }
    },
    "rules": {
      "README.md": {
        "path": "src/domain/rules/README.md",
        "content": "# –ü–∞–∫–µ—Ç `rules`\n\n–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–µ–≥–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏–π/—É–º–µ–Ω–∏–π + –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã.\n\n| –§–∞–π–ª          | –ó–∞–¥–∞—á–∞ |\n|---------------|-------|\n| `move.py`     | `legal_moves`, `validate_move` |\n| `ability.py`  | `legal_targets`, `validate_ability` |"
      },
      "__init__.py": {
        "path": "src/domain/rules/__init__.py",
        "content": null
      },
      "ability.py": {
        "path": "src/domain/rules/ability.py",
        "content": null
      },
      "move.py": {
        "path": "src/domain/rules/move.py",
        "content": null
      }
    }
  },
  "interfaces": {}
}